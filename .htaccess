# === Root .htaccess (public_html) ===

# Serve index.html by default without showing it
DirectoryIndex index.html

# Avoid Apache MultiViews weirdness (can cause wrong matches)
Options -MultiViews

RewriteEngine On
RewriteBase /

# --- Canonicalize: hide index.html ---
# /, /folder/ already fine; if user requests /index.html or /folder/index.html, redirect to the clean URL.
RewriteCond %{THE_REQUEST} \s/+(.*/)?index\.html [NC]
RewriteRule ^ %1 [R=301,L]

# --- Canonicalize: hide .html extension ---
# If the user explicitly requests /page.html, redirect to /page
RewriteCond %{THE_REQUEST} \s/+([^.]+)\.html [NC]
RewriteRule ^ %1 [R=301,L]

# --- Internal rewrite: map clean URLs to the actual .html file if it exists ---
# Only rewrite when it's not an existing file or directory,
# and when a corresponding .html file actually exists.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^(.+)$ $1.html [L]

# Custom 404 page
ErrorDocument 404 /404.html
